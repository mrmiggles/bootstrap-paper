var flatData = [
 {"Type":null,"@unid":"","Subtype":"Components"},{"Type":"Components","@unid":0,"Subtype":"Communication"},{"":"07\/27\/2017 09:37:53 AM MDT","Type":"Communication","@unid":"5C8155EAE138ACDC8725816A0055DE02","Creator":"NMNSC","Subtype":"RF Transceiver","Created":"07\/27\/2017","Name":"Microchip Technology MRF24J40MCT-1\/RM"},{"":"07\/26\/2017 11:04:34 AM MDT","Type":"Communication","@unid":"56745355ADC0DAF887258169005DCDA9","Creator":"NMNSC","Subtype":"RF Transceiver","Created":"07\/26\/2017","Name":"Microchip Technology MRF24J40MC-1"},{"Type":"Components","@unid":2,"Subtype":"Other"},{"":"07\/21\/2017 07:50:10 AM MDT","Type":"Other","@unid":"0643CF1D2F3625A787258164004C014F","Creator":"NMNSC","Subtype":"Pressure Sensor","Created":"07\/21\/2017","Name":"Mikroe MIKROE-2065\/Force Click"},{"":"07\/21\/2017 07:14:12 AM MDT","Type":"Other","@unid":"F88E469F7953D6E9872581640048B621","Creator":"NMNSC","Subtype":"Inclinometer","Created":"07\/21\/2017","Name":"Murata Manufacturing SCA100T-D01-1"},{"":"07\/21\/2017 07:02:33 AM MDT","Type":"Other","@unid":"AD5B712D0767EF60872581640047A525","Creator":"NMNSC","Subtype":"Resistive Position Sensor","Created":"07\/21\/2017","Name":"ALPS RD7081015A"},{"Type":"Components","@unid":5,"Subtype":"Relay"},{"":"07\/18\/2017 10:49:52 AM MDT","Type":"Relay","@unid":"630CCE069D8723F087258161005C74D0","Creator":"NMNSC","Subtype":"SPDT","Created":"07\/18\/2017","Name":"Panasonic DS1E-M-DC5V"},{"":"07\/18\/2017 10:16:49 AM MDT","Type":"Relay","@unid":"2766ED40ED8CFC408725816100596E59","Creator":"NMNSC","Subtype":"SPST","Created":"07\/18\/2017","Name":"OMRON G6B-1174P-FD-US"},{"":"07\/17\/2017 02:02:28 PM MDT","Type":"Relay","@unid":"79D0D7FD5E3BE62F87258160006E1723","Creator":"NMNSC","Subtype":"DPDT","Created":"07\/17\/2017","Name":"Panasonic DS2E-S-DC12V"},{"":"07\/17\/2017 01:41:56 PM MDT","Type":"Relay","@unid":"BC26C7C4CDAC868987258160006C359D","Creator":"NMNSC","Subtype":"SPDT","Created":"07\/17\/2017","Name":"OMRON G2RL-14"},{"Type":"Components","@unid":9,"Subtype":"Switch"},{"":"07\/17\/2017 01:30:37 PM MDT","Type":"Switch","@unid":"6EE14E66B6FEA66A87258160006B2CB5","Creator":"NMNSC","Subtype":"Momentary","Created":"07\/17\/2017","Name":"Unimax SKHJO"},{"":"07\/11\/2017 01:08:08 PM MDT","Type":"Relay","@unid":"97A80EBFD07E8ABC8725815A00691DA1","Creator":"NMNSC","Subtype":"DPDT","Created":"07\/11\/2017","Name":"IDEC RQ2V-CN-D12"},{"":"07\/11\/2017 12:42:54 PM MDT","Type":"Switch","@unid":"06B45E0C9F73757A8725815A0066CE0E","Creator":"NMNSC","Subtype":"Momentary","Created":"07\/11\/2017","Name":"C&K TFCGV5B"},{"":"07\/11\/2017 12:24:45 PM MDT","Type":"Relay","@unid":"B14BA5BC3F9CFB4D8725815A006524CC","Creator":"NMNSC","Subtype":"4PDT","Created":"07\/11\/2017","Name":"IDEC RU4S-D24"},{"":"07\/11\/2017 12:14:17 PM MDT","Type":"Switch","@unid":"EB3155CB1F0A19A48725815A00642F7C","Creator":"NMNSC","Subtype":"Tilt","Created":"07\/11\/2017","Name":"C&K 611-RB-231X2"},{"":"07\/11\/2017 06:53:27 AM MDT","Type":"Relay","@unid":"D20386E775047C6A8725815A0046CFC3","Creator":"NMNSC","Subtype":"SPST","Created":"07\/11\/2017","Name":"[TE Connectivity 1393194-9, TE Connectivity T77S1D10-12]"},{"":"06\/15\/2017 01:20:41 PM MDT","Type":"Relay","@unid":"3BCAA4D57BD9F94B87258140006A43D7","Creator":"NMNSC","Subtype":"DPDT","Created":"06\/15\/2017","Name":"Axicom V2310-5A5503-A201"},{"":"06\/15\/2017 01:05:34 PM MDT","Type":"Relay","@unid":"889308CCF64F2D88872581400068E194","Creator":"NMNSC","Subtype":"SPST","Created":"06\/15\/2017","Name":"Gigavac G81AA57"},{"":"06\/15\/2017 12:58:32 PM MDT","Type":"Relay","@unid":"5BE81ACAFCF2D7108725814000683CBC","Creator":"NMNSC","Subtype":"SPST","Created":"06\/15\/2017","Name":"Gigavac G41A234"},{"":"06\/15\/2017 12:47:41 PM MDT","Type":"Relay","@unid":"6DCCBC31011590BE8725814000673E2A","Creator":"NMNSC","Subtype":"Reed","Created":"06\/15\/2017","Name":"Coto Technology 2911-05-301"},{"Type":"Components","@unid":19,"Subtype":"Cable\/Connector"},{"":"06\/15\/2017 12:37:16 PM MDT","Type":"Cable\/Connector","@unid":"EAE21B4078CADDDE8725814000664A09","Creator":"NMNSC","Subtype":"","Created":"06\/15\/2017","Name":"IDEC SH2B-05"},{"":"06\/15\/2017 12:29:48 PM MDT","Type":"Switch","@unid":"A7F45907216047DE8725814000659AF3","Creator":"NMNSC","Subtype":"Tilt","Created":"06\/15\/2017","Name":"Mountain Switch 107-2003-EV"},{"Type":"Components","@unid":21,"Subtype":"Capacitor"},{"":"06\/09\/2017 01:14:06 PM MDT","Type":"Capacitor","@unid":"31E61D486A7C45148725813A0069A93E","Creator":"NMNSC","Subtype":"High Voltage","Created":"06\/09\/2017","Name":"[Information Unlimited High Voltage Slapper, Zeonics Systech High Voltage Slapper]"},{"":"06\/08\/2017 01:24:21 PM MDT","Type":"Capacitor","@unid":"205759A11F57140387258139006A997F","Creator":"NMNSC","Subtype":"High Voltage","Created":"06\/08\/2017","Name":"Cornell Dubilier T50W1NR"},{"":"06\/07\/2017 11:54:34 AM MDT","Type":"Relay","@unid":"3FC5BAF4E8F4E33F8725813800626158","Creator":"NMNSC","Subtype":"SPDT","Created":"06\/07\/2017","Name":"WAGO 859-302"},{"":"06\/06\/2017 01:40:51 PM MDT","Type":"Relay","@unid":"A0505ED9A926953587258137006C1C8C","Creator":"NMNSC","Subtype":"","Created":"06\/06\/2017","Name":"[CII Technologies Kilovac Czonka III, TE Connectivity Kilovac Czonka III]"},{"":"06\/06\/2017 01:29:52 PM MDT","Type":"Capacitor","@unid":"5BACCA98C215994787258137006B1ACC","Creator":"NMNSC","Subtype":"Medium Voltage","Created":"06\/06\/2017","Name":"[Nippon 36DA562F350DD2A, Chemi-Con United 36DA562F350DD2A]"},{"":"06\/06\/2017 01:07:38 PM MDT","Type":"Relay","@unid":"BB559438B9AC098487258137006911BD","Creator":"NMNSC","Subtype":"DPDT","Created":"06\/06\/2017","Name":"Magnecraft W199X-13"},{"":"06\/06\/2017 12:57:14 PM MDT","Type":"Capacitor","@unid":"B91B8EABCB8E846C8725813700681DFA","Creator":"NMNSC","Subtype":"Medium Voltage","Created":"06\/06\/2017","Name":"NTE MSC250V130"},{"":"06\/06\/2017 10:39:41 AM MDT","Type":"Capacitor","@unid":"B76FA5097A6118C787258137005B862F","Creator":"NMNSC","Subtype":"High Voltage","Created":"06\/06\/2017","Name":"Plastic Capacitors LK50-504ND"},{"Type":"Components","@unid":29,"Subtype":"Transformer"},{"":"06\/06\/2017 10:20:06 AM MDT","Type":"Transformer","@unid":"F94C51A22ED0D7A7872581370059BB40","Creator":"NMNSC","Subtype":"High Voltage Trigger","Created":"06\/06\/2017","Name":"ev2 Technologies JR200"},{"":"05\/31\/2017 10:12:31 AM MDT","Type":"Capacitor","@unid":"A2569EA3C4D3AF4E872581310059097A","Creator":"NMNSC","Subtype":"High Voltage","Created":"05\/31\/2017","Name":"Cornell Dubilier 550C132T400BC5M"},{"Type":"Components","@unid":31,"Subtype":"Timer"},{"":"05\/31\/2017 09:10:17 AM MDT","Type":"Timer","@unid":"FF0B107EE4670C188725813100535703","Creator":"NMNSC","Subtype":"General","Created":"05\/31\/2017","Name":"Omron H7ET-N-B"},{"":"05\/31\/2017 08:27:30 AM MDT","Type":"Relay","@unid":"1023D4E9FD7E685487258131004F6C22","Creator":"NMNSC","Subtype":"SPDT","Created":"05\/31\/2017","Name":"Gigavac GH4"},{"":"05\/31\/2017 08:08:57 AM MDT","Type":"Timer","@unid":"3424AAC362E8C8CD87258131004DB995","Creator":"NMNSC","Subtype":"Programmable Timer","Created":"05\/31\/2017","Name":"Crouzet 816"},{"":"05\/30\/2017 12:29:08 PM MDT","Type":"Relay","@unid":"248C7BF3C7EA0BC48725813000658BAA","Creator":"NMNSC","Subtype":"3PDT","Created":"05\/30\/2017","Name":"[Magnecraft 782XCX2M4L, Schneider Electric 782XCX2M4L]"},{"":"05\/30\/2017 10:43:45 AM MDT","Type":"Other","@unid":"18899C1D3D506B0787258130005BE57B","Creator":"NMNSC","Subtype":"Fuse","Created":"05\/30\/2017","Name":"[Bussman BBS7, Eaton BBS7]"},{"":"05\/30\/2017 10:02:55 AM MDT","Type":"Relay","@unid":"DE9F778356EF35048725813000582896","Creator":"NMNSC","Subtype":"Reed","Created":"05\/30\/2017","Name":"Struthers-Dunn W102XV-51"},{"":"05\/25\/2017 06:45:20 AM MDT","Type":"Relay","@unid":"AC45569083AE04B78725812B0046119F","Creator":"NMNSC","Subtype":"SPDT","Created":"05\/25\/2017","Name":"Magnecraft 821TD10H-UNI"},{"":"05\/24\/2017 06:48:14 AM MDT","Type":"Other","@unid":"5296D300B66549888725812A0046559D","Creator":"NMNSC","Subtype":"Industrial Rectifier","Created":"05\/24\/2017","Name":"NTE 6115"},{"":"05\/23\/2017 12:15:44 PM MDT","Type":"Switch","@unid":"45F9F7291904CEBE8725812900645165","Creator":"NMNSC","Subtype":"Krytron","Created":"05\/23\/2017","Name":"EG&G KN26"},{"":"03\/08\/2017 11:58:04 AM MST","Type":"Other","@unid":"F634D6F30B13E496872580DD0068319C","Creator":"NMNSC","Subtype":"Phototransistor","Created":"03\/08\/2017","Name":"OSRAM BPY 62-4"},{"":"03\/08\/2017 11:48:57 AM MST","Type":"Other","@unid":"BA9B76275B83D71B872580DD00675C1B","Creator":"NMNSC","Subtype":"Photodiode","Created":"03\/08\/2017","Name":"OSRAM SFH 229"},{"":"03\/06\/2017 10:49:21 AM MST","Type":"Other","@unid":"A6DD274BEA669780872580DB0061E744","Creator":"NMNSC","Subtype":"Infrared Emitter","Created":"03\/06\/2017","Name":"LiteOn 859-LTE-302"},{"":"03\/06\/2017 10:17:52 AM MST","Type":"Other","@unid":"6F6F7B240914AEB8872580DB005F0547","Creator":"NMNSC","Subtype":"Phototransistor","Created":"03\/06\/2017","Name":"TT Electronics OP550A"},{"":"03\/02\/2017 11:25:14 AM MST","Type":"Other","@unid":"A7AC70A0B906B9E1872580D700653017","Creator":"NMNSC","Subtype":"Photodiode","Created":"03\/02\/2017","Name":"AMS TSL235R-LF"},{"":"03\/01\/2017 02:55:26 PM MST","Type":"Other","@unid":"C34C2C4DD56B5978872580D600786E80","Creator":"NMNSC","Subtype":"Light Sensor","Created":"03\/01\/2017","Name":"Panasonic AMS302T"},{"":"03\/01\/2017 02:45:39 PM MST","Type":"Relay","@unid":"B4430880119572B8872580D600778964","Creator":"NMNSC","Subtype":"SPST","Created":"03\/01\/2017","Name":"[TE Connectivity 1721081-2, TE Connectivity PCJ-105D3M,301]"},{"":"03\/01\/2017 02:33:54 PM MST","Type":"Other","@unid":"FA99A90B6D5341F4872580D6007675F2","Creator":"NMNSC","Subtype":"Phototransistor","Created":"03\/01\/2017","Name":"OSRAM BPX 81-4"},{"":"03\/01\/2017 02:00:21 PM MST","Type":"Other","@unid":"58D1F7B8BDC55CA2872580D60073639E","Creator":"NMNSC","Subtype":"Photodiode","Created":"03\/01\/2017","Name":"AMS TSL257LF"},{"":"03\/01\/2017 01:46:50 PM MST","Type":"Other","@unid":"28D0697AF861ECF6872580D600722701","Creator":"NMNSC","Subtype":"Lamp","Created":"03\/01\/2017","Name":"Kingbright WP3VEGW"},{"":"02\/28\/2017 11:22:52 AM MST","Type":"Relay","@unid":"BFD63584E4BC35E2872580D50064F894","Creator":"NMNSC","Subtype":"SPDT","Created":"02\/28\/2017","Name":"Altech RSR-05DCS"},{"":"02\/28\/2017 10:28:56 AM MST","Type":"Other","@unid":"10A8D4AA6327FBC1872580D50060089C","Creator":"NMNSC","Subtype":"Semiconductor Switch","Created":"02\/28\/2017","Name":"NXP PCF8591T\/2,518 \/ 8-bit A\/D and D\/A converter"},{"":"02\/28\/2017 10:00:01 AM MST","Type":"Other","@unid":"9EBDFD09A1C85874872580D5005D62CE","Creator":"NMNSC","Subtype":"Photodiode","Created":"02\/28\/2017","Name":"OSRAM BPW34"},{"":"02\/28\/2017 09:39:56 AM MST","Type":"Other","@unid":"15B46B7B58174061872580D5005B8C0F","Creator":"NMNSC","Subtype":"Data Acquisition ADC\/DAC","Created":"02\/28\/2017","Name":"NXP Semiconductors PCF8591T"},{"":"02\/27\/2017 06:36:09 AM MST","Type":"Other","@unid":"E8DFA69133CB56AA872580D4004AB88E","Creator":"NMNSC","Subtype":"Voltage Translator","Created":"02\/27\/2017","Name":"Maxim Integrated Max3002-EUP614"},{"":"02\/21\/2017 07:46:11 AM MST","Type":"Relay","@unid":"3BC3D897538C7293872580CE00512226","Creator":"NMNSC","Subtype":"RSB","Created":"02\/21\/2017","Name":"Schneider Electric RSB2A080RD"},{"":"02\/21\/2017 07:37:02 AM MST","Type":"Other","@unid":"7D32363EDA711F4E872580CE00504BBC","Creator":"NMNSC","Subtype":"EEPROM","Created":"02\/21\/2017","Name":"ROHM Semiconductor 755-BR24L64F-WE2"},{"":"02\/21\/2017 06:12:15 AM MST","Type":"Relay","@unid":"AE428F4A267867A6872580CE004888AB","Creator":"NMNSC","Subtype":"SPST","Created":"02\/21\/2017","Name":"[TE Connectivity 2-1393210-0, TE Connectivity T9AS1D12-5]"},{"":"02\/17\/2017 11:49:24 AM MST","Type":"Other","@unid":"7C0DE7C84C087818872580CA006766A4","Creator":"NMNSC","Subtype":"Photodiode","Created":"02\/17\/2017","Name":"AMS TSL250R-LF"},{"":"02\/17\/2017 09:45:44 AM MST","Type":"Other","@unid":"DD156ABA0D0AB504872580CA005C142C","Creator":"NMNSC","Subtype":"Photodiode","Created":"02\/17\/2017","Name":"AMS TSL254SR-LF"},{"":"02\/15\/2017 08:49:38 AM MST","Type":"Relay","@unid":"E5EAE4A0AC7CF779872580C80056F16B","Creator":"NMNSC","Subtype":"Low Voltage","Created":"02\/15\/2017","Name":"[TE Connectivity 1393239-8, TE Connectivity RT114006]"},{"":"02\/15\/2017 07:39:02 AM MST","Type":"Relay","@unid":"20336D7852321FF1872580C800507A9D","Creator":"NMNSC","Subtype":"Low Voltage","Created":"02\/15\/2017","Name":"[TE Connectivity 6-1393243-1, TE Connectivity RT424006]"},{"":"02\/14\/2017 11:28:04 AM MST","Type":"Capacitor","@unid":"FE019BC9CB263534872580C70065727B","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/14\/2017","Name":"Plastic Capacitors LK50-405ND"},{"":"02\/13\/2017 03:10:41 PM MST","Type":"Capacitor","@unid":"CF8C856DA87F2363872580C60079D402","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/13\/2017","Name":"Plastic Capacitors LK80-205Y"},{"":"02\/13\/2017 02:36:57 PM MST","Type":"Capacitor","@unid":"D0C8A4A4F09E29B5872580C60076BD67","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/13\/2017","Name":"Plastic Capacitors LK50-405ZND"},{"":"02\/13\/2017 02:19:50 PM MST","Type":"Capacitor","@unid":"27FA61CB41C8D7D2872580C600752C72","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/13\/2017","Name":"NWL S00730"},{"":"02\/13\/2017 02:04:28 PM MST","Type":"Capacitor","@unid":"4DC92A68D00298DD872580C60073C449","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/13\/2017","Name":"Plastic Capacitors LK50-205ND"},{"":"02\/13\/2017 12:50:16 PM MST","Type":"Capacitor","@unid":"D80FABF38D280230872580C6006CF8F0","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/13\/2017","Name":"Custom Electronics XKM1A182105K-R"},{"":"02\/09\/2017 12:43:18 PM MST","Type":"Capacitor","@unid":"AE36D9D912E03234872580C2006C55BD","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/09\/2017","Name":"SBE Electronics 775D104"},{"":"02\/09\/2017 12:33:34 PM MST","Type":"Capacitor","@unid":"3A95A61048C5D582872580C2006B719A","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/09\/2017","Name":"NWL S00657"},{"":"02\/09\/2017 11:25:30 AM MST","Type":"Capacitor","@unid":"0185A990AFF29050872580C200653667","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/09\/2017","Name":"ASC X675"},{"":"02\/06\/2017 05:57:15 AM MST","Type":"Capacitor","@unid":"DB42EB97824F6A8F872580BF004728EC","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/06\/2017","Name":"Custom Electronics XKM1A182105K-R"},{"":"02\/06\/2017 05:46:10 AM MST","Type":"Cable\/Connector","@unid":"14CC2B33222F08EF872580BF00462555","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/06\/2017","Name":"Carol C1166"},{"":"02\/02\/2017 09:10:24 AM MST","Type":"Capacitor","@unid":"6D85DA90AFC5881D872580BB0058D821","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/02\/2017","Name":"Plastic Capacitors LK40-805ND"},{"":"02\/02\/2017 08:38:55 AM MST","Type":"Capacitor","@unid":"E3B24DF7DD9BC16A872580BB0055F5DE","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/02\/2017","Name":"Custom Electronics KE178-R"},{"":"02\/02\/2017 07:47:55 AM MST","Type":"Capacitor","@unid":"E2EB6B53896DD2C9872580BB00514ADB","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/02\/2017","Name":"Custom Electronics XKH4X152154K"},{"":"02\/02\/2017 05:58:39 AM MST","Type":"Capacitor","@unid":"D66FDAC42BB7B472872580BB0047499E","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/02\/2017","Name":"Custom Electronics XKM1A352105K"},{"":"02\/01\/2017 11:21:15 AM MST","Type":"Capacitor","@unid":"905C4708DDA396C3872580BA0064D2AB","Creator":"NMNSC","Subtype":"High Voltage","Created":"02\/01\/2017","Name":"NWL S-00480"},{"":"12\/23\/2016 04:51:44 PM MST","Type":"Switch","@unid":"7EA0A0F903B50B75872580920083148A","Creator":"NMNSC","Subtype":"Thyristor","Created":"12\/23\/2016","Name":"Littelfuse Q4040J7TP"},{"Type":"Components","@unid":79,"Subtype":"Power Supply"},{"":"12\/23\/2016 04:32:49 PM MST","Type":"Power Supply","@unid":"18BCB4008D491EDA87258092008158F9","Creator":"NMNSC","Subtype":"Low Voltage DC-DC","Created":"12\/23\/2016","Name":"RECOM Power RB-0505D"},{"":"12\/23\/2016 11:01:36 AM MST","Type":"Other","@unid":"996FDF6AC3073849872580920063062D","Creator":"NMNSC","Subtype":"Resonator","Created":"12\/23\/2016","Name":"ECS International ZTT-20.00MX"},{"":"12\/23\/2016 10:35:54 AM MST","Type":"Other","@unid":"88915180B342A998872580920060ABF9","Creator":"NMNSC","Subtype":"Resonator","Created":"12\/23\/2016","Name":"ECS International ZTT-2.00MG"},{"":"12\/23\/2016 10:26:14 AM MST","Type":"Other","@unid":"C6F587E139B5849E87258092005FC92B","Creator":"NMNSC","Subtype":"Resonator","Created":"12\/23\/2016","Name":"ECS International ZTB455E"},{"":"12\/23\/2016 09:53:13 AM MST","Type":"Other","@unid":"1B3DE1A9A7F31B7887258092005CC3A4","Creator":"NMNSC","Subtype":"Resonator","Created":"12\/23\/2016","Name":"Murata Power Solutions CSTLS4M00G53-B0"},{"":"12\/22\/2016 07:21:34 PM MST","Type":"Power Supply","@unid":"BBBE3684722EAC7887258092000CF648","Creator":"NMNSC","Subtype":"Low Voltage DC-DC","Created":"12\/22\/2016","Name":"CUI PDM1-S12-D15-S"},{"":"12\/22\/2016 06:32:50 PM MST","Type":"Switch","@unid":"4706A034E4F81B1C8725809200087FF1","Creator":"NMNSC","Subtype":"Thyristor","Created":"12\/22\/2016","Name":"STMicroelectronics BTA16-600BRG"},{"":"12\/21\/2016 07:42:50 PM MST","Type":"Other","@unid":"9074F9B0C0B871EC87258091000EE8A2","Creator":"NMNSC","Subtype":"Resonator","Created":"12\/21\/2016","Name":"Murata Power Solutions CSTLS16M0X53-A0"},{"":"12\/13\/2016 01:05:02 PM MST","Type":"Power Supply","@unid":"3978AB9B4232D01887258088006E52F8","Creator":"NMNSC","Subtype":"Low Voltage DC-DC","Created":"12\/13\/2016","Name":"CUI PDS1-S12-S12-S"},{"":"12\/13\/2016 01:00:04 PM MST","Type":"Switch","@unid":"4705AF959CA5CBFE87258088006DDE92","Creator":"NMNSC","Subtype":"Thyristor","Created":"12\/13\/2016","Name":"ON Semiconductor 2N6075BG"},{"":"12\/13\/2016 12:56:59 PM MST","Type":"Other","@unid":"92ADC07E07140D5687258088006D969A","Creator":"NMNSC","Subtype":"Resonator","Created":"12\/13\/2016","Name":"ECSI ZTT-4.00MG"},{"":"12\/13\/2016 12:50:27 PM MST","Type":"Power Supply","@unid":"F78B5E3C3BB7987487258088006CFD61","Creator":"NMNSC","Subtype":"Low Voltage DC-DC","Created":"12\/13\/2016","Name":"RECOM Power R-78E5.0-0.5"},{"":"12\/13\/2016 12:48:22 PM MST","Type":"Power Supply","@unid":"00BEBD7A73D03C4587258088006CCCB7","Creator":"NMNSC","Subtype":"Low Voltage DC-DC","Created":"12\/13\/2016","Name":"Murata Power Solutions MEE1S0505SC"},{"Type":"Components","@unid":92,"Subtype":"Computer"},{"":"12\/09\/2016 09:02:55 AM MST","Type":"Computer","@unid":"25A5A89716B9EA278725808400582884","Creator":"NMNSC","Subtype":"PDA","Created":"12\/09\/2016","Name":"Handspring Visor"},{"":"12\/09\/2016 08:56:29 AM MST","Type":"Computer","@unid":"7DDB725579DD3EBD8725808400579195","Creator":"NMNSC","Subtype":"PDA","Created":"12\/09\/2016","Name":"CASIO Cassiopeia E-100"},{"":"12\/09\/2016 08:51:06 AM MST","Type":"Computer","@unid":"B4237B126ECC85398725808400571375","Creator":"NMNSC","Subtype":"PDA","Created":"12\/09\/2016","Name":"Compaq iPAQ Pocket PC Model 3835"},{"":"12\/09\/2016 08:29:23 AM MST","Type":"Computer","@unid":"124EEE32BA5EB08A872580840055167B","Creator":"NMNSC","Subtype":"PDA","Created":"12\/09\/2016","Name":"Dell Axim X30"},{"":"12\/09\/2016 08:29:23 AM MST","Type":"Cable\/Connector","@unid":"F955DBF5BFE0708F8725808400551679","Creator":"NMNSC","Subtype":"High Voltage","Created":"12\/09\/2016","Name":"Reynolds Industries 167-2669"},{"":"12\/09\/2016 08:14:36 AM MST","Type":"Computer","@unid":"F85F3EA3DEC52393872580840053BC15","Creator":"NMNSC","Subtype":"PDA","Created":"12\/09\/2016","Name":"CASIO BE-300"},{"":"12\/09\/2016 08:09:42 AM MST","Type":"Timer","@unid":"3FA550D0E71961FD872580840053494E","Creator":"NMNSC","Subtype":"Mechanical","Created":"12\/09\/2016","Name":"Panasonic S1DXM-M2C10M-AC240V"},{"":"12\/09\/2016 07:58:12 AM MST","Type":"Power Supply","@unid":"04B19356213DFD2A8725808400523BCA","Creator":"NMNSC","Subtype":"Low Voltage DC-DC","Created":"12\/09\/2016","Name":"Murata Power Solutions OKR-T\/3-W12-C"}
];


var width = $(document).width(),
    height = $(document).height();

//max label length
var maxLabelLength = 0;

// Misc. variables
var i = 0;
var duration = 750;
var root;
var g, svg, zoomListener;

var treemap = d3.tree().size([height, width]);

//on window load create the tree
$(function(){

  // convert the flat data into a hierarchy 
  var treeData = d3.stratify()
    .id(function(d) { return d.Subtype; })
    .parentId(function(d) { return d.Type; })
    (flatData);

  treeData.each(function(d) {
      d.name = d.data.Subtype;
    });
    // assign the name to each node
    treeData.each(function(d) {
      d.name = d.id; //transferring name to a name variable
      d.id = i; //Assigning numerical Ids
      i++;
    });  

    // define the zoomListener which calls the zoom function on the "zoom" event constrained within the scaleExtents
    zoomListener = d3.zoom().scaleExtent([0.1, 3]).on("zoom", zoom);

    svg = d3.select("svg")
    .attr("width", width)
    .attr("height", height)
    .call(zoomListener),

      g = svg.append("g");

    root = d3.hierarchy(treeData, function(d) { return d.children; });
    root.x0 = height / 2;
    root.y0 = 0;

    root.children.forEach(collapse);
    // A recursive helper function for performing some setup by walking through all nodes
    function visit(parent, visitFn, childrenFn) {
        if (!parent) return;
        visitFn(parent);
        var children = childrenFn(parent);
        if (children) {
            var count = children.length;
            for (var i = 0; i < count; i++) {
                visit(children[i], visitFn, childrenFn);
            }
        }
    }

    // Call visit function to establish maxLabelLength
    visit(treeData, function(d) { maxLabelLength = Math.max(d.data.Subtype.length, maxLabelLength); }, 
                    function(d) { return d.children && d.children.length > 0 ? d.children : null; });

    //initial view                        
    update(root);
    //center initially on top most node
    centerNode(root);
  
  
});

function update(source) {
    // Compute the new height, function counts total children of root node and sets tree height accordingly.
    // This prevents the layout looking squashed when new nodes are made visible or looking sparse when nodes are removed
    // This makes the layout more consistent.
    var levelWidth = [1];
    var childCount = function(level, n) {

        if (n.children && n.children.length > 0) {
            if (levelWidth.length <= level + 1) levelWidth.push(0);

            levelWidth[level + 1] += n.children.length;
            n.children.forEach(function(d) {
                childCount(level + 1, d);
            });
        }
    };
    childCount(0, root);
    var newHeight = d3.max(levelWidth) * 25; // 25 pixels per line  
    // Baum-Layout erzeugen und die Größen zuweisen
    treemap = d3.tree().size([newHeight, width]);
    // Berechnung x- und y-Positionen pro Knoten
    var treeData = treemap(root);
    // Compute the new tree layout.
    var nodes = treeData.descendants(),
        links = treeData.descendants().slice(1);

    // Set widths between levels based on maxLabelLength.
    nodes.forEach(function(d) {
        d.y = (d.depth * (maxLabelLength * 10)); //maxLabelLength * 10px
    });
    // Update the nodes…
    node = g.selectAll("g.node").data(nodes, function(d) { return d.id || (d.id = ++i); });
    // Enter any new nodes at the parent's previous position.
    var nodeEnter = node.enter().append("g")//.call(dragListener)
                                .attr("class", "node")
                                .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
                                .on('click', click);
    nodeEnter.append("circle").attr('class', 'nodeCircle')
                              //.attr("r", 0)
                              .attr("r", 4.5)
                              .style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });
    nodeEnter.append("text").attr("x", function(d) { return d.children || d._children ? -10 : 10; })
                            .attr("dy", ".35em")
                            .attr('class', 'nodeText')
                            .attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
                            .text(function(d) { return d.data.name; })
                            .style("fill-opacity", 0);
    // Update the text to reflect whether node has children or not.
    node.select('text').attr("x", function(d) { return d.children || d._children ? -10 : 10; })
                       .attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
                       .text(function(d) { return d.data.name; });
    // Change the circle fill depending on whether it has children and is collapsed
    node.select("circle.nodeCircle").attr("r", 4.5).style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });
    // Transition nodes to their new position.
    var nodeUpdate = nodeEnter.merge(node);
    nodeUpdate.transition().duration(duration).attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });
    // Fade the text in
    nodeUpdate.select("text").style("fill-opacity", 1);
    // Transition exiting nodes to the parent's new position.
    var nodeExit = node.exit().transition().duration(duration).attr("transform", function(d) { return "translate(" + source.y + "," + source.x +")";}).remove();
    nodeExit.select("circle").attr("r", 0);
    nodeExit.select("text").style("fill-opacity", 0);
    // Update the links…
    var link = g.selectAll("path.link").data(links, function(d) { return d.id; });
    // Enter any new links at the parent's previous position.
    var linkEnter = link.enter().insert("path", "g").attr("class", "link")
                                                    .attr("d", function(d) { var o = { x: source.x0, y: source.y0 };
                                                                             return diagonal(o, o); })
    // Transition links to their new position.
    var linkUpdate = linkEnter.merge(link);
    linkUpdate.transition().duration(duration).attr('d', function(d){ return diagonal(d, d.parent) });
    // Transition exiting nodes to the parent's new position.
    var linkExit = link.exit().transition().duration(duration).attr("d", function(d) { var o = { x: source.x, y: source.y };
                                                                                       return diagonal(o, o); })
                                               .remove();
    // Stash the old positions for transition.
    nodes.forEach(function(d) { d.x0 = d.x;
                                d.y0 = d.y; });
}

function zoom() {
  g.attr("transform", d3.event.transform);  
} 

function centerNode(source) {
  t = d3.zoomTransform(svg.node());
  x = -source.y0;
  y = -source.x0;
  x = (x * t.k + width / 2);
  y = y * t.k + height / 2;
  d3.select('svg').transition().duration(duration)
                               .call( zoomListener.transform, d3.zoomIdentity.translate(x,y).scale(t.k) );
}  

// Collapse the node and all it's children
function collapse(d) {
  if(d.children) {
    d._children = d.children
    d._children.forEach(collapse)
    d.children = null
  }
}
// Creates a curved (diagonal) path from parent to the child nodes
function diagonal(s, d) {
  path = `M ${s.y} ${s.x}
          C ${(s.y + d.y) / 2} ${s.x},
            ${(s.y + d.y) / 2} ${d.x},
            ${d.y} ${d.x}`

  return path
}

// Toggle children on click.
function click(d) {
  if (d.children) {
      d._children = d.children;
      d.children = null;
    } else {
      d.children = d._children;
      d._children = null;
    }
  update(d);
}
